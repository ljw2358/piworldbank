<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b1220" />
  <title>PiWorldBank</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#101a33;
      --muted:#a7b0c6;
      --text:#e9eefc;
      --accent:#8b5cf6;
      --accent2:#6d28d9;
      --line:rgba(255,255,255,.10);
      --btn:#1a2550;
      --shadow:0 12px 30px rgba(0,0,0,.35);
      --radius:18px;
      --font: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--font);
      background: radial-gradient(1200px 700px at 25% 0%, rgba(139,92,246,.35), transparent 55%),
                  radial-gradient(900px 600px at 80% 20%, rgba(109,40,217,.25), transparent 60%),
                  var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:28px 14px 50px;
    }
    .wrap{width:100%; max-width:520px;}
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:12px;
    }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .logo{
      width:42px; height:42px; border-radius:14px;
      display:grid; place-items:center;
      background: linear-gradient(145deg, rgba(139,92,246,.95), rgba(109,40,217,.95));
      box-shadow: var(--shadow);
      font-weight:800;
    }
    .brand h1{margin:0; font-size:20px; letter-spacing:.2px;}
    .brand p{margin:3px 0 0; font-size:12px; color:var(--muted)}
    .lang{
      position:relative;
    }
    .lang button{
      border:1px solid var(--line);
      background:rgba(16,26,51,.65);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      display:flex; align-items:center; gap:8px;
      box-shadow:0 8px 18px rgba(0,0,0,.18);
    }
    .lang button:active{transform:translateY(1px)}
    .menu{
      position:absolute;
      right:0;
      top:48px;
      min-width:190px;
      background:rgba(16,26,51,.95);
      border:1px solid var(--line);
      border-radius:16px;
      overflow:hidden;
      box-shadow: var(--shadow);
      display:none;
      z-index:10;
      backdrop-filter: blur(8px);
    }
    .menu.open{display:block}
    .menu .item{
      padding:12px 14px;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      cursor:pointer;
      border-bottom:1px solid rgba(255,255,255,.06);
      font-size:14px;
    }
    .menu .item:last-child{border-bottom:none}
    .menu .item:hover{background:rgba(255,255,255,.06)}
    .chip{
      font-size:12px;
      color:var(--muted);
    }

    .card{
      margin-top:14px;
      background:rgba(16,26,51,.72);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:18px;
      backdrop-filter: blur(10px);
    }
    .title{
      font-size:26px;
      margin:4px 0 2px;
      letter-spacing:.2px;
      font-weight:850;
    }
    .sub{
      margin:0 0 14px;
      color:var(--muted);
      font-size:13px;
      line-height:1.4;
    }
    .grid{
      display:grid;
      gap:12px;
    }
    .row{
      display:flex; gap:10px; flex-wrap:wrap;
    }
    .btn{
      flex:1;
      min-width:170px;
      padding:14px 14px;
      border-radius:16px;
      border:1px solid var(--line);
      background: linear-gradient(145deg, rgba(139,92,246,.92), rgba(109,40,217,.92));
      color:white;
      font-weight:800;
      cursor:pointer;
      box-shadow:0 10px 22px rgba(0,0,0,.22);
      transition:.15s;
    }
    .btn.secondary{
      background: rgba(26,37,80,.65);
      color: var(--text);
      font-weight:700;
    }
    .btn:active{transform:translateY(1px)}
    .btn:disabled{
      opacity:.45;
      cursor:not-allowed;
      transform:none;
    }

    .sectionTitle{
      margin:10px 0 6px;
      font-size:18px;
      font-weight:900;
    }
    .sectionHint{
      margin:0 0 10px;
      font-size:13px;
      color:var(--muted);
      line-height:1.5;
    }
    .field{
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .label{
      font-size:12px;
      color:var(--muted);
    }
    input{
      width:100%;
      padding:14px 14px;
      border-radius:16px;
      border:1px solid var(--line);
      background: rgba(10,16,34,.55);
      color: var(--text);
      outline:none;
      font-size:14px;
    }
    input::placeholder{color:rgba(167,176,198,.65)}
    .footer{
      margin-top:14px;
      color:rgba(167,176,198,.85);
      font-size:12px;
      line-height:1.5;
    }
    .status{
      margin-top:10px;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(139,92,246,.25);
      background: rgba(139,92,246,.08);
      color: rgba(233,238,252,.95);
      font-size:12px;
      min-height:44px;
      display:flex; align-items:center;
      gap:10px;
    }
    .dot{
      width:8px; height:8px; border-radius:999px;
      background: var(--accent);
      box-shadow:0 0 0 5px rgba(139,92,246,.14);
    }

    /* RTL (Arabic) */
    body[dir="rtl"] .topbar{flex-direction:row-reverse}
    body[dir="rtl"] .brand{flex-direction:row-reverse}
    body[dir="rtl"] .lang .menu{right:auto; left:0}
    body[dir="rtl"] .row{flex-direction:row-reverse}
    body[dir="rtl"] input{text-align:right}
  </style>

  <!-- Pi SDK (ÌïÑÏàò) -->
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>

<body>
  <div class="wrap">
    <!-- Top -->
    <div class="topbar">
      <div class="brand">
        <div class="logo">œÄ</div>
        <div>
          <h1 id="appTitleTop">PiWorldBank</h1>
          <p id="appSubtitleTop">Pi Ecosystem Web App (Sandbox/Test)</p>
        </div>
      </div>

      <!-- Language (PWB2025 Î∞©Ïãù: ÏûêÎèôÍ∞êÏßÄ + ÏàòÎèôÎ≥ÄÍ≤Ω) -->
      <div class="lang">
        <button id="langBtn" type="button" aria-label="Language">
          üåê <span id="langLabel">English</span> <span style="opacity:.7">‚ñæ</span>
        </button>
        <div id="langMenu" class="menu" role="menu" aria-hidden="true">
          <div class="item" data-lang="en"><span>English</span><span class="chip">EN</span></div>
          <div class="item" data-lang="ko"><span>ÌïúÍµ≠Ïñ¥</span><span class="chip">KR</span></div>
          <div class="item" data-lang="zh"><span>‰∏≠ÊñáÔºàÁÆÄ‰ΩìÔºâ</span><span class="chip">ZH</span></div>
          <div class="item" data-lang="ar"><span>ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</span><span class="chip">AR</span></div>
        </div>
      </div>
    </div>

    <!-- Main card -->
    <div class="card">
      <div class="title" data-i18n="title">PiWorldBank</div>
      <div class="sub" data-i18n="subtitle">Pi Ecosystem Web App (Sandbox/Test)</div>

      <div class="row">
        <button class="btn" id="btnLogin" data-i18n="login">Login with Pi</button>
        <button class="btn secondary" id="btnLogout" data-i18n="logout" disabled>Logout</button>
      </div>

      <div class="sectionTitle" data-i18n="sendTitle">Send (Demo UI)</div>
      <div class="sectionHint" data-i18n="sendHint">
        This is UI-only for now. We will connect payments after hosting is stable.
      </div>

      <div class="grid">
        <div class="field">
          <div class="label" data-i18n="recipientLabel">Recipient (Pi username or address)</div>
          <input id="recipient" placeholder="e.g. pioneer123 or G...address" />
        </div>

        <div class="field">
          <div class="label" data-i18n="amountLabel">Amount (Pi)</div>
          <input id="amount" placeholder="e.g. 1.00" />
        </div>

        <button class="btn secondary" id="btnSend" data-i18n="sendNext" disabled>
          Send (Next Step)
        </button>
      </div>

      <div class="status" id="statusBox">
        <span class="dot"></span>
        <span id="statusText" data-i18n="statusReady">Status: Pi SDK ready. Please login.</span>
      </div>

      <div class="footer" id="footerText" data-i18n="footer">
        Tip: If language does not switch automatically, tap üåê and select your language.
      </div>
    </div>
  </div>

  <script>
    /***********************
     * 1) I18N (PWB2025 Î∞©Ïãù)
     ***********************/
    const translations = {
      en: {
        langName: "English",
        title: "PiWorldBank",
        subtitle: "Pi Ecosystem Web App (Sandbox/Test)",
        login: "Login with Pi",
        logout: "Logout",
        sendTitle: "Send (Demo UI)",
        sendHint: "This is UI-only for now. We will connect payments after hosting is stable.",
        recipientLabel: "Recipient (Pi username or address)",
        amountLabel: "Amount (Pi)",
        sendNext: "Send (Next Step)",
        statusReady: "Status: Pi SDK ready. Please login.",
        statusLoggedIn: "Status: Logged in. You can test UI fields now.",
        statusLoggedOut: "Status: Logged out.",
        statusNotInPi: "Status: Please open this page inside Pi Browser to use Pi login.",
        footer: "Tip: If language does not switch automatically, tap üåê and select your language.",
        alertLoggedIn: "Logged in (Sandbox/Test).",
        alertLoggedOut: "Logged out.",
        alertSendDemo: "Demo UI only. We'll connect real payments later."
      },
      ko: {
        langName: "ÌïúÍµ≠Ïñ¥",
        title: "ÌååÏù¥ÏõîÎìúÎ±ÖÌÅ¨",
        subtitle: "ÌååÏù¥ ÏÉùÌÉúÍ≥Ñ Ïõπ Ïï± (ÏÉåÎìúÎ∞ïÏä§/ÌÖåÏä§Ìä∏)",
        login: "ÌååÏù¥Î°ú Î°úÍ∑∏Ïù∏",
        logout: "Î°úÍ∑∏ÏïÑÏõÉ",
        sendTitle: "ÏÜ°Í∏à (Îç∞Î™® UI)",
        sendHint: "ÌòÑÏû¨Îäî UI Îç∞Î™®ÏûÖÎãàÎã§. Ìò∏Ïä§ÌåÖÏù¥ ÏïàÏ†ïÎêòÎ©¥ Í≤∞Ï†úÎ•º Ïó∞Í≤∞ÌïòÍ≤†ÏäµÎãàÎã§.",
        recipientLabel: "Î∞õÎäî ÏÇ¨Îûå (ÌååÏù¥ ÏÇ¨Ïö©ÏûêÎ™Ö ÎòêÎäî Ï£ºÏÜå)",
        amountLabel: "Í∏àÏï° (ÌååÏù¥)",
        sendNext: "ÏÜ°Í∏à (Îã§Ïùå Îã®Í≥Ñ)",
        statusReady: "ÏÉÅÌÉú: Pi SDK Ï§ÄÎπÑ ÏôÑÎ£å. Î°úÍ∑∏Ïù∏Ìï¥ Ï£ºÏÑ∏Ïöî.",
        statusLoggedIn: "ÏÉÅÌÉú: Î°úÍ∑∏Ïù∏ ÏôÑÎ£å. Ïù¥Ï†ú UI ÏûÖÎ†•ÏùÑ ÌÖåÏä§Ìä∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.",
        statusLoggedOut: "ÏÉÅÌÉú: Î°úÍ∑∏ÏïÑÏõÉÎêòÏóàÏäµÎãàÎã§.",
        statusNotInPi: "ÏÉÅÌÉú: Pi Î°úÍ∑∏Ïù∏ÏùÑ ÏÇ¨Ïö©ÌïòÎ†§Î©¥ Pi BrowserÏóêÏÑú Ïó¥Ïñ¥Ï£ºÏÑ∏Ïöî.",
        footer: "ÌåÅ: ÏûêÎèô Ï†ÑÌôòÏù¥ Ïïà ÎêòÎ©¥ üåê Î≤ÑÌäºÏùÑ ÎàåÎü¨ Ïñ∏Ïñ¥Î•º ÏÑ†ÌÉùÌï¥ Ï£ºÏÑ∏Ïöî.",
        alertLoggedIn: "Î°úÍ∑∏Ïù∏ÎêòÏóàÏäµÎãàÎã§(ÏÉåÎìúÎ∞ïÏä§/ÌÖåÏä§Ìä∏).",
        alertLoggedOut: "Î°úÍ∑∏ÏïÑÏõÉÎêòÏóàÏäµÎãàÎã§.",
        alertSendDemo: "ÌòÑÏû¨Îäî Îç∞Î™® UIÏûÖÎãàÎã§. Ïã§Ï†ú Í≤∞Ï†úÎäî Ïù¥ÌõÑ Ïó∞Í≤∞Îê©ÎãàÎã§."
      },
      zh: {
        langName: "‰∏≠Êñá",
        title: "Ê¥æ‰∏ñÁïåÈì∂Ë°å",
        subtitle: "Pi ÁîüÊÄÅÁ≥ªÁªü Web Â∫îÁî®ÔºàÊµãËØïÁâàÔºâ",
        login: "‰ΩøÁî® Pi ÁôªÂΩï",
        logout: "ÈÄÄÂá∫ÁôªÂΩï",
        sendTitle: "ÂèëÈÄÅÔºàÊºîÁ§∫ÁïåÈù¢Ôºâ",
        sendHint: "ÁõÆÂâç‰ªÖ‰∏∫ÁïåÈù¢ÊºîÁ§∫„ÄÇÊâòÁÆ°Á®≥ÂÆöÂêéÂ∞ÜËøûÊé•ÁúüÂÆûÊîØ‰ªò„ÄÇ",
        recipientLabel: "Êî∂Ê¨æ‰∫∫ÔºàPi Áî®Êà∑ÂêçÊàñÂú∞ÂùÄÔºâ",
        amountLabel: "ÈáëÈ¢ùÔºàPiÔºâ",
        sendNext: "ÂèëÈÄÅÔºà‰∏ã‰∏ÄÊ≠•Ôºâ",
        statusReady: "Áä∂ÊÄÅÔºöPi SDK Â∑≤Â∞±Áª™ÔºåËØ∑ÁôªÂΩï„ÄÇ",
        statusLoggedIn: "Áä∂ÊÄÅÔºöÂ∑≤ÁôªÂΩï„ÄÇÁé∞Âú®ÂèØ‰ª•ÊµãËØïÁïåÈù¢ËæìÂÖ•„ÄÇ",
        statusLoggedOut: "Áä∂ÊÄÅÔºöÂ∑≤ÈÄÄÂá∫ÁôªÂΩï„ÄÇ",
        statusNotInPi: "Áä∂ÊÄÅÔºöËØ∑Âú® Pi ÊµèËßàÂô®‰∏≠ÊâìÂºÄ‰ª•‰ΩøÁî® Pi ÁôªÂΩï„ÄÇ",
        footer: "ÊèêÁ§∫ÔºöËã•Êú™Ëá™Âä®ÂàáÊç¢ËØ≠Ë®ÄÔºåËØ∑ÁÇπÂáª üåê Âπ∂ÈÄâÊã©ËØ≠Ë®Ä„ÄÇ",
        alertLoggedIn: "Â∑≤ÁôªÂΩïÔºàÊµãËØïÁâàÔºâ„ÄÇ",
        alertLoggedOut: "Â∑≤ÈÄÄÂá∫ÁôªÂΩï„ÄÇ",
        alertSendDemo: "‰ªÖÊºîÁ§∫ÁïåÈù¢„ÄÇÁ®çÂêé‰ºöËøûÊé•ÁúüÂÆûÊîØ‰ªò„ÄÇ"
      },
      ar: {
        langName: "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",
        title: "ÿ®ÿßŸä ŸàŸàÿ±ŸÑÿØ ÿ®ŸÜŸÉ",
        subtitle: "ÿ™ÿ∑ÿ®ŸäŸÇ ŸàŸäÿ® ŸÑŸÜÿ∏ÿßŸÖ Pi (Ÿàÿ∂ÿπ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±)",
        login: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ Pi",
        logout: "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨",
        sendTitle: "ÿ•ÿ±ÿ≥ÿßŸÑ (Ÿàÿßÿ¨Ÿáÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©)",
        sendHint: "Ÿáÿ∞Ÿá Ÿàÿßÿ¨Ÿáÿ© ŸÅŸÇÿ∑ ÿßŸÑÿ¢ŸÜ. ÿ≥ŸÜÿ±ÿ®ÿ∑ ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™ ŸÑÿßÿ≠ŸÇÿßŸã ÿ®ÿπÿØ ÿßÿ≥ÿ™ŸÇÿ±ÿßÿ± ÿßŸÑÿßÿ≥ÿ™ÿ∂ÿßŸÅÿ©.",
        recipientLabel: "ÿßŸÑŸÖÿ≥ÿ™ŸÑŸÖ (ÿßÿ≥ŸÖ ŸÖÿ≥ÿ™ÿÆÿØŸÖ Pi ÿ£Ÿà ÿßŸÑÿπŸÜŸàÿßŸÜ)",
        amountLabel: "ÿßŸÑŸÖÿ®ŸÑÿ∫ (Pi)",
        sendNext: "ÿ•ÿ±ÿ≥ÿßŸÑ (ÿßŸÑÿÆÿ∑Ÿàÿ© ÿßŸÑÿ™ÿßŸÑŸäÿ©)",
        statusReady: "ÿßŸÑÿ≠ÿßŸÑÿ©: Pi SDK ÿ¨ÿßŸáÿ≤. Ÿäÿ±ÿ¨Ÿâ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ.",
        statusLoggedIn: "ÿßŸÑÿ≠ÿßŸÑÿ©: ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ. ŸäŸÖŸÉŸÜŸÉ ÿßÿÆÿ™ÿ®ÿßÿ± ÿßŸÑÿ≠ŸÇŸàŸÑ ÿßŸÑÿ¢ŸÜ.",
        statusLoggedOut: "ÿßŸÑÿ≠ÿßŸÑÿ©: ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨.",
        statusNotInPi: "ÿßŸÑÿ≠ÿßŸÑÿ©: ÿßŸÑÿ±ÿ¨ÿßÿ° ŸÅÿ™ÿ≠ ÿßŸÑÿµŸÅÿ≠ÿ© ÿØÿßÿÆŸÑ ŸÖÿ™ÿµŸÅÿ≠ Pi ŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ.",
        footer: "ŸÖŸÑÿßÿ≠ÿ∏ÿ©: ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™ÿ™ÿ∫Ÿäÿ± ÿßŸÑŸÑÿ∫ÿ© ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸãÿå ÿßÿ∂ÿ∫ÿ∑ üåê ŸàÿßÿÆÿ™ÿ± ÿßŸÑŸÑÿ∫ÿ©.",
        alertLoggedIn: "ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ (Ÿàÿ∂ÿπ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±).",
        alertLoggedOut: "ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨.",
        alertSendDemo: "Ÿàÿßÿ¨Ÿáÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ŸÅŸÇÿ∑. ÿ≥ŸÜÿ±ÿ®ÿ∑ ÿßŸÑŸÖÿØŸÅŸàÿπÿßÿ™ ŸÑÿßÿ≠ŸÇÿßŸã."
      }
    };

    // PWB2025 Î∞©Ïãù: (1) Ï†ÄÏû•Îêú Ïñ∏Ïñ¥ Ïö∞ÏÑ† (2) Î∏åÎùºÏö∞Ï†Ä Ïñ∏Ïñ¥ ÏûêÎèô Í∞êÏßÄ (3) Í∏∞Î≥∏ en
    function detectLang() {
      const saved = localStorage.getItem("pwb_lang");
      if (saved && translations[saved]) return saved;

      const nav = (navigator.language || "en").toLowerCase();
      // Ï§ëÍµ≠Ïñ¥(Í∞ÑÏ≤¥/Î≤àÏ≤¥ Ìè¨Ìï®) -> zh
      if (nav.startsWith("zh")) return "zh";
      // ÌïúÍµ≠Ïñ¥ -> ko
      if (nav.startsWith("ko")) return "ko";
      // ÏïÑÎûçÏñ¥ -> ar
      if (nav.startsWith("ar")) return "ar";
      return "en";
    }

    let currentLang = detectLang();

    function applyLang(lang) {
      if (!translations[lang]) lang = "en";
      currentLang = lang;
      localStorage.setItem("pwb_lang", lang);

      // RTL Ï≤òÎ¶¨
      document.body.dir = (lang === "ar") ? "rtl" : "ltr";
      document.documentElement.lang = (lang === "ar") ? "ar" : (lang === "zh" ? "zh" : (lang === "ko" ? "ko" : "en"));

      // UI ÌÖçÏä§Ìä∏ Ï†ÅÏö©
      document.querySelectorAll("[data-i18n]").forEach(el => {
        const key = el.getAttribute("data-i18n");
        if (translations[lang][key]) el.textContent = translations[lang][key];
      });

      // ÏÉÅÎã® Î∏åÎûúÎìú ÌÖçÏä§Ìä∏ÎèÑ Í∞ôÏù¥ ÎßûÏ∂îÍ∏∞
      document.getElementById("appTitleTop").textContent = translations[lang].title;
      document.getElementById("appSubtitleTop").textContent = translations[lang].subtitle;

      // lang label
      document.getElementById("langLabel").textContent = translations[lang].langName;
    }

    // Ïñ∏Ïñ¥ Î©îÎâ¥ UI
    const langBtn = document.getElementById("langBtn");
    const langMenu = document.getElementById("langMenu");

    langBtn.addEventListener("click", () => {
      langMenu.classList.toggle("open");
      langMenu.setAttribute("aria-hidden", langMenu.classList.contains("open") ? "false" : "true");
    });

    document.addEventListener("click", (e) => {
      if (!langMenu.contains(e.target) && !langBtn.contains(e.target)) {
        langMenu.classList.remove("open");
        langMenu.setAttribute("aria-hidden", "true");
      }
    });

    langMenu.querySelectorAll(".item").forEach(item => {
      item.addEventListener("click", () => {
        applyLang(item.dataset.lang);
        langMenu.classList.remove("open");
        langMenu.setAttribute("aria-hidden", "true");
        // ÏÉÅÌÉú Î¨∏Íµ¨ÎèÑ ÌòÑÏû¨ Ïñ∏Ïñ¥Î°ú Ïú†ÏßÄ
        refreshStatus();
      });
    });

    // Ï≤òÏùå Ï†ÅÏö©
    applyLang(currentLang);

    /***********************
     * 2) Pi SDK (ÏµúÏÜå ÏïàÏ†ï)
     ***********************/
    const statusText = document.getElementById("statusText");
    const btnLogin = document.getElementById("btnLogin");
    const btnLogout = document.getElementById("btnLogout");
    const btnSend = document.getElementById("btnSend");

    let isLoggedIn = false;

    function inPiBrowser() {
      // Pi BrowserÎäî window.Pi Ï°¥Ïû¨
      return typeof window.Pi !== "undefined";
    }

    function setStatus(key) {
      statusText.textContent = translations[currentLang][key] || translations.en[key] || "";
    }

    function refreshStatus() {
      if (!inPiBrowser()) {
        setStatus("statusNotInPi");
        btnLogin.disabled = true;
        btnLogout.disabled = true;
        btnSend.disabled = true;
        return;
      }
      // Pi SDK Ï§ÄÎπÑ
      if (!isLoggedIn) {
        setStatus("statusReady");
        btnLogin.disabled = false;
        btnLogout.disabled = true;
        btnSend.disabled = true;
      } else {
        setStatus("statusLoggedIn");
        btnLogin.disabled = true;
        btnLogout.disabled = false;
        btnSend.disabled = false; // Îç∞Î™® Î≤ÑÌäºÎßå ÌôúÏÑ±
      }
    }

    // Pi SDK init
    if (inPiBrowser()) {
      // sandbox / test ÌôòÍ≤Ω Í∏∞Î≥∏
      Pi.init({ version: "2.0", sandbox: true });
    }

    btnLogin.addEventListener("click", async () => {
      try {
        if (!inPiBrowser()) {
          alert(translations[currentLang].statusNotInPi);
          return;
        }
        // Í∞úÎ∞ú Îã®Í≥Ñ: Pi.authenticateÎ°ú ÏµúÏÜå Î°úÍ∑∏Ïù∏Îßå
        const scopes = ["username"]; // ÏµúÏÜå
        const authResult = await Pi.authenticate(scopes, (payment) => {
          // Í≤∞Ï†ú ÌõÖ (ÌòÑÏû¨ ÎØ∏ÏÇ¨Ïö©)
        });

        // Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ
        isLoggedIn = true;
        alert(translations[currentLang].alertLoggedIn);
        refreshStatus();

      } catch (err) {
        // Ïã§Ìå®Ìï¥ÎèÑ Ïï±ÏùÄ Ï£ΩÏßÄ ÏïäÍ≤å
        console.log(err);
        setStatus("statusReady");
      }
    });

    btnLogout.addEventListener("click", () => {
      // SDKÏóê "logout"Ïù¥ Î≥ÑÎèÑ ÏóÜÏñ¥ÏÑú UI ÏÉÅÌÉúÎßå Ï¥àÍ∏∞Ìôî
      isLoggedIn = false;
      alert(translations[currentLang].alertLoggedOut);
      refreshStatus();
    });

    btnSend.addEventListener("click", () => {
      alert(translations[currentLang].alertSendDemo);
    });

    // Ï¥àÍ∏∞ ÏÉÅÌÉú Î∞òÏòÅ
    refreshStatus();
  </script>
</body>
</html>
