<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>World Pi Bank</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icon-192.png" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif;background:#140a2a;color:#fff;margin:0}
    .wrap{max-width:720px;margin:0 auto;padding:24px}
    .card{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:16px;margin:12px 0}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .btn{flex:1;min-width:140px;padding:14px 16px;border-radius:12px;border:0;cursor:pointer;font-weight:700}
    .btn.primary{background:#7b3fe4;color:#fff}
    .btn.ghost{background:transparent;color:#fff;border:1px solid rgba(255,255,255,.2)}
    .muted{color:#b9aee0}
    .lang{display:flex;gap:8px;justify-content:flex-end;margin-bottom:8px}
    .lang button{background:transparent;border:1px solid rgba(255,255,255,.2);color:#fff;border-radius:999px;padding:4px 10px;cursor:pointer}
    .toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%);background:#1f153a;border:1px solid rgba(255,255,255,.15);padding:12px 16px;border-radius:12px;display:none}
    .log{max-height:220px;overflow:auto;font-size:14px;white-space:pre-wrap}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="lang">
      <button onclick="setLang('en')">EN</button>
      <button onclick="setLang('ko')">KR</button>
      <button onclick="setLang('zh')">ZH</button>
    </div>

    <h1>World Pi Bank</h1>
    <p class="muted" id="subtitle">파이 생태계 기반 세계 최초의 디지털 은행</p>

    <div class="row" style="margin:16px 0 8px">
      <button class="btn primary" onclick="demoOpen()"><span id="demoBtn">데모 열기</span></button>
      <button class="btn ghost" onclick="fakeLogin()"><span id="loginBtn">로그인</span></button>
    </div>

    <div class="card">
      <h3>송금 / 결제</h3>
      <p class="muted">누구나 빠른 파이 결제.</p>
      <div class="row">
        <button class="btn primary" onclick="payDemo()">결제 시뮬레이션</button>
        <button class="btn ghost" onclick="transferDemo()">송금 시뮬레이션</button>
      </div>
    </div>

    <div class="card">
      <h3>리워드</h3>
      <p class="muted">사용·참여에 따른 포인트 적립.</p>
      <div class="row">
        <button class="btn primary" onclick="rewardDemo()">포인트 적립</button>
        <button class="btn ghost" onclick="redeemDemo()">포인트 사용</button>
      </div>
    </div>

    <div class="card">
      <h3>예치 (APY 31.4%)</h3>
      <p class="muted">유연한 기간, 투명한 금리.</p>
      <div class="row">
        <button class="btn primary" onclick="stakeDemo()">예치하기</button>
        <button class="btn ghost" onclick="unstakeDemo()">해지하기</button>
      </div>
    </div>

    <div class="card">
      <h3>UBI (기본소득)</h3>
      <p class="muted">파이로 구현하는 웹3 기본소득.</p>
      <div class="row">
        <button class="btn primary" onclick="ubiClaim()">UBI 수령</button>
        <button class="btn ghost" onclick="ubiHistory()">지급 내역</button>
      </div>
    </div>

    <div class="card">
      <h3>이벤트 로그</h3>
      <div id="log" class="log"></div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    // ——— 데모 상태 ———
    const state = { logged:false, balance: 314.159, points: 0, stake: 0, lang:'ko' };
    const $ = s => document.querySelector(s);
    const log = (msg) => { const l=$("#log"); l.textContent = `[${new Date().toLocaleTimeString()}] ${msg}\n` + l.textContent; }
    const toast = (msg) => { const t=$("#toast"); t.textContent=msg; t.style.display='block'; setTimeout(()=>t.style.display='none',1600); }

    function setLang(lang){
      state.lang=lang;
      const text={
        en:{subtitle:"The first digital bank on the Pi ecosystem",demo:"Open Demo",login:"Log in"},
        ko:{subtitle:"파이 생태계 기반 세계 최초의 디지털 은행",demo:"데모 열기",login:"로그인"},
        zh:{subtitle:"基于 Pi 生态的首个数字银行",demo:"打开演示",login:"登录"}
      }[lang];
      $("#subtitle").textContent=text.subtitle;
      $("#demoBtn").textContent=text.demo;
      $("#loginBtn").textContent=text.login;
      toast(`Language: ${lang.toUpperCase()}`);
    }

    function demoOpen(){ toast("데모 모드 활성화"); log("Demo mode ON (프론트엔드 시뮬레이션)"); }
    function fakeLogin(){ state.logged=!state.logged; toast(state.logged?"로그인 완료":"로그아웃"); log(`로그인 상태: ${state.logged}`); }

    function payDemo(){
      const amount = Number(prompt("결제 금액(PI) 입력:", "3.14"));
      if(!amount || amount<=0) return;
      if(amount>state.balance){ toast("잔액 부족"); log("결제 실패: 잔액 부족"); return; }
      state.balance-=amount;
      toast(`결제 성공: ${amount.toFixed(2)} PI`);
      log(`결제 성공, 잔액: ${state.balance.toFixed(2)} PI`);
    }
    function transferDemo(){
      const to = prompt("수취인(지갑 주소 또는 이름):", "pioneer_001");
      const amount = Number(prompt("송금 금액(PI):", "1.00"));
      if(!to || !amount) return;
      if(amount>state.balance){ toast("잔액 부족"); log("송금 실패: 잔액 부족"); return; }
      state.balance-=amount;
      toast(`송금 완료 → ${to} (${amount.toFixed(2)} PI)`);
      log(`송금 완료, 잔액: ${state.balance.toFixed(2)} PI`);
    }

    function rewardDemo(){ state.points+=10; toast("포인트 +10"); log(`포인트 적립, 누적 ${state.points}`); }
    function redeemDemo(){
      if(state.points<10){ toast("포인트 부족"); log("포인트 사용 실패"); return; }
      state.points-=10; toast("포인트 10 사용"); log(`포인트 사용, 잔여 ${state.points}`);
    }

    function stakeDemo(){
      const amount = Number(prompt("예치 금액(PI):", "5.00"));
      if(!amount || amount<=0) return;
      if(amount>state.balance){ toast("잔액 부족"); log("예치 실패: 잔액 부족"); return; }
      state.balance-=amount; state.stake+=amount;
      toast(`예치 완료: ${amount.toFixed(2)} PI`);
      log(`예치잔액 ${state.stake.toFixed(2)} PI / 지갑잔액 ${state.balance.toFixed(2)} PI`);
    }
    function unstakeDemo(){
      if(state.stake<=0){ toast("예치 없음"); log("해지 실패: 예치 없음"); return; }
      const amount = Math.min(state.stake, Number(prompt("해지 금액(PI):", state.stake.toFixed(2))));
      if(!amount || amount<=0) return;
      state.stake-=amount; state.balance+=amount;
      toast(`해지 완료: ${amount.toFixed(2)} PI`);
      log(`예치잔액 ${state.stake.toFixed(2)} / 지갑잔액 ${state.balance.toFixed(2)}`);
    }

    function ubiClaim(){ toast("UBI 0.314 PI 지급(가상)"); state.balance+=0.314; log("UBI 지급 +0.314 PI"); }
    function ubiHistory(){ toast("최근 3회 지급 내역(가상)"); log("UBI 내역: +0.314 / +0.314 / +0.314"); }

    // PWA 등록(있으면)
    if ("serviceWorker" in navigator) navigator.serviceWorker.register("sw.js").catch(()=>{});
    setLang('ko');
  </script>
</body>
