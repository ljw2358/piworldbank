<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>World Pi Bank · 월드파이은행</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="icons/icon-192.png" />
  <meta name="theme-color" content="#1e0b3a" />
  <style>
    :root{
      --bg:#120627;--panel:#1b0d36;--muted:#b9aee0;--line:#2a1850;
      --prime:#7b3fe4;--prime-2:#9a60ff;--text:#ffffff
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Malgun Gothic,sans-serif}
    .wrap{max-width:960px;margin:0 auto;padding:20px}
    header{display:flex;align-items:center;gap:12px;justify-content:space-between;margin-bottom:10px}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:36px;height:36px;border-radius:9px;background:var(--prime);display:grid;place-items:center;font-weight:900}
    .muted{color:var(--muted)}
    .lang{display:flex;gap:8px}
    .chip{background:transparent;border:1px solid var(--line);color:var(--text);padding:6px 10px;border-radius:999px;cursor:pointer}
    .row{display:flex;flex-wrap:wrap;gap:12px}
    .btn{padding:12px 14px;border:0;border-radius:12px;cursor:pointer;font-weight:700}
    .btn.primary{background:var(--prime);color:#fff}
    .btn.ghost{background:transparent;border:1px solid var(--line);color:#fff}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .card{grid-column:span 12;background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:16px}
    @media(min-width:800px){
      .card.sm6{grid-column:span 6}
      .card.sm4{grid-column:span 4}
    }
    h1{font-size:20px;margin:0}
    h2{margin:6px 0 12px 0;font-size:18px}
    h3{margin:0 0 8px 0}
    .stat{display:flex;gap:16px;flex-wrap:wrap}
    .stat .pill{background:#160a2e;border:1px solid var(--line);border-radius:999px;padding:8px 12px}
    .list{margin:6px 0 0 0;padding:0 0 0 16px}
    .toast{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);background:#211246;border:1px solid var(--line);padding:10px 14px;border-radius:12px;display:none;z-index:50}
    .log{max-height:220px;overflow:auto;background:#0d0720;border:1px solid var(--line);padding:12px;border-radius:12px;font-size:13px;white-space:pre-wrap}
    .hr{height:1px;background:var(--line);margin:12px 0}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- 헤더 -->
    <header>
      <div class="brand">
        <div class="logo">π</div>
        <div>
          <h1>World Pi Bank</h1>
          <div id="subtitle" class="muted">파이 생태계 기반 디지털 은행 데모</div>
        </div>
      </div>
      <div class="row">
        <div class="lang">
          <button class="chip" onclick="setLang('ko')">KR</button>
          <button class="chip" onclick="setLang('en')">EN</button>
          <button class="chip" onclick="setLang('zh')">ZH</button>
        </div>
        <button class="btn ghost" onclick="toggleLogin()" id="loginBtn">로그인</button>
        <button class="btn primary" onclick="demoOpen()" id="demoBtn">데모 열기</button>
      </div>
    </header>

    <!-- 상태 카드 -->
    <div class="grid">
      <div class="card sm6">
        <h2>지갑 요약</h2>
        <div class="stat">
          <div class="pill">잔액: <b id="bal">314.159 ⨀</b></div>
          <div class="pill">포인트: <b id="pts">0 P</b></div>
          <div class="pill">예치: <b id="stk">0.000 ⨀</b></div>
          <div class="pill">상태: <b id="sess">게스트</b></div>
        </div>
      </div>
      <div class="card sm6">
        <h2>빠른 행동</h2>
        <div class="row">
          <button class="btn primary" onclick="payDemo()">결제 시뮬레이션</button>
          <button class="btn ghost" onclick="transferDemo()">송금 시뮬레이션</button>
          <button class="btn primary" onclick="rewardDemo()">포인트 적립</button>
          <button class="btn ghost" onclick="redeemDemo()">포인트 사용</button>
        </div>
      </div>

      <!-- 송금/결제 -->
      <div class="card sm6">
        <h2>송금 · 결제</h2>
        <p class="muted">누구나 빠른 파이 결제.</p>
        <div class="row">
          <button class="btn primary" onclick="payDemo()">결제하기</button>
          <button class="btn ghost" onclick="transferDemo()">송금하기</button>
        </div>
        <ul class="list muted">
          <li>결제는 잔액에서 차감됩니다.</li>
          <li>잔액 부족 시 실패로 기록됩니다.</li>
        </ul>
      </div>

      <!-- 리워드 -->
      <div class="card sm6">
        <h2>리워드</h2>
        <p class="muted">사용/참여에 따라 포인트를 적립하고 사용할 수 있습니다.</p>
        <div class="row">
          <button class="btn primary" onclick="rewardDemo()">포인트 +10</button>
          <button class="btn ghost" onclick="redeemDemo()">포인트 10 사용</button>
        </div>
      </div>

      <!-- 예치 -->
      <div class="card sm6">
        <h2>예치 (APY 31.4%)</h2>
        <p class="muted">유연한 기간, 투명한 금리.</p>
        <div class="row">
          <button class="btn primary" onclick="stakeDemo()">예치하기</button>
          <button class="btn ghost" onclick="unstakeDemo()">해지하기</button>
        </div>
      </div>

      <!-- UBI -->
      <div class="card sm6">
        <h2>UBI (기본소득)</h2>
        <p class="muted">파이로 구현하는 웹3 기본소득.</p>
        <div class="row">
          <button class="btn primary" onclick="ubiClaim()">UBI 수령</button>
          <button class="btn ghost" onclick="ubiHistory()">지급 내역</button>
        </div>
      </div>

      <!-- 고객센터 / FAQ -->
      <div class="card sm6">
        <h2>고객센터</h2>
        <div class="muted">문의: support@worldpibank.example</div>
        <div class="hr"></div>
        <h3>FAQ</h3>
        <ul class="list muted">
          <li>이 데모는 정적 페이지에서 동작하는 **시뮬레이션**입니다.</li>
          <li>버튼 클릭 시 토스트/로그로 결과가 표시됩니다.</li>
          <li>PWA 설치는 지원되며, 브라우저/기기 정책에 따라 배너 노출이 다를 수 있습니다.</li>
        </ul>
      </div>

      <!-- 로그 -->
      <div class="card sm6">
        <h2>이벤트 로그</h2>
        <div id="log" class="log"></div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script>
    // ===== 공용 유틸 =====
    const $ = s => document.querySelector(s);
    const state = { logged:false, balance:314.159, points:0, stake:0, lang:'ko' };
    const textByLang = {
      en:{
        sub:"Digital bank demo on the Pi ecosystem",
        login:"Log in", logout:"Log out", demo:"Open Demo",
        paid:"Payment success", payFail:"Payment failed: insufficient balance",
        sent:"Transfer complete", rewardPlus:"Points +10", rewardUseFail:"Not enough points",
        stakeDone:"Staked", unstakeNone:"No stake to withdraw", unstakeDone:"Unstaked",
        ubiPaid:"UBI +0.314 PI", lang:"Language"
      },
      ko:{
        sub:"파이 생태계 기반 디지털 은행 데모",
        login:"로그인", logout:"로그아웃", demo:"데모 열기",
        paid:"결제 성공", payFail:"결제 실패: 잔액 부족",
        sent:"송금 완료", rewardPlus:"포인트 +10", rewardUseFail:"포인트 부족",
        stakeDone:"예치 완료", unstakeNone:"예치 없음", unstakeDone:"해지 완료",
        ubiPaid:"UBI +0.314 PI", lang:"언어"
      },
      zh:{
        sub:"基于 Pi 生态的数字银行演示",
        login:"登录", logout:"登出", demo:"打开演示",
        paid:"支付成功", payFail:"支付失败：余额不足",
        sent:"转账完成", rewardPlus:"积分 +10", rewardUseFail:"积分不足",
        stakeDone:"质押完成", unstakeNone:"无可赎回质押", unstakeDone:"赎回完成",
        ubiPaid:"UBI +0.314 PI", lang:"语言"
      }
    };
    const log = (msg) => { const l=$("#log"); l.textContent = `[${new Date().toLocaleTimeString()}] ${msg}\n` + l.textContent; }
    const toast = (msg) => { const t=$("#toast"); t.textContent=msg; t.style.display='block'; setTimeout(()=>t.style.display='none',1500); }
    const fmt = (n)=> Number(n).toFixed(3);

    function render(){
      $("#bal").textContent = `${fmt(state.balance)} ⨀`;
      $("#pts").textContent = `${state.points} P`;
      $("#stk").textContent = `${fmt(state.stake)} ⨀`;
      $("#sess").textContent = state.logged ? "로그인" : "게스트";
      const t = textByLang[state.lang];
      $("#subtitle").textContent = t.sub;
      $("#loginBtn").textContent = state.logged ? t.logout : t.login;
      $("#demoBtn").textContent = t.demo;
    }

    // ===== 언어/세션 =====
    function setLang(lang){ state.lang=lang; toast(`${textByLang[lang].lang}: ${lang.toUpperCase()}`); render(); }
    function toggleLogin(){ state.logged=!state.logged; toast(state.logged?"로그인 완료":"로그아웃"); render(); }
    function demoOpen(){ toast("데모 모드 활성화"); log("Demo mode ON (프론트엔드 시뮬레이션)"); }

    // ===== 기능 데모 =====
    function payDemo(){
      const t = textByLang[state.lang];
      const amount = Number(prompt("결제 금액(PI):","3.14"));
      if(!amount || amount<=0) return;
      if(amount>state.balance){ toast(t.payFail); log("결제 실패: 잔액 부족"); return; }
      state.balance -= amount; render();
      toast(`${t.paid}: ${fmt(amount)} PI`); log(`결제 ${fmt(amount)} PI → 잔액 ${fmt(state.balance)} PI`);
    }

    function transferDemo(){
      const to = prompt("수취인(지갑/이름):","pioneer_001");
      if(!to) return;
      const amount = Number(prompt("송금 금액(PI):","1.00"));
      if(!amount || amount<=0) return;
      if(amount>state.balance){ toast("잔액 부족"); log("송금 실패: 잔액 부족"); return; }
      state.balance -= amount; render();
      toast(`송금 완료 → ${to} (${fmt(amount)} PI)`); log(`송금 ${fmt(amount)} PI → 잔액 ${fmt(state.balance)} PI`);
    }

    function rewardDemo(){ state.points += 10; render(); toast(textByLang[state.lang].rewardPlus); log("포인트 적립 +10"); }
    function redeemDemo(){
      if(state.points < 10){ toast(textByLang[state.lang].rewardUseFail); log("포인트 사용 실패"); return; }
      state.points -= 10; render(); toast("포인트 10 사용"); log("포인트 사용 -10");
    }

    function stakeDemo(){
      const amount = Number(prompt("예치 금액(PI):","5.00"));
      if(!amount || amount<=0) return;
      if(amount>state.balance){ toast("잔액 부족"); log("예치 실패: 잔액 부족"); return; }
      state.balance-=amount; state.stake+=amount; render();
      toast(`${textByLang[state.lang].stakeDone}: ${fmt(amount)} PI`); log(`예치 ${fmt(amount)} PI / 예치잔액 ${fmt(state.stake)} PI`);
    }
    function unstakeDemo(){
      if(state.stake<=0){ toast(textByLang[state.lang].unstakeNone); log("해지 실패: 예치 없음"); return; }
      const amount = Math.min(state.stake, Number(prompt("해지 금액(PI):", fmt(state.stake))));
      if(!amount || amount<=0) return;
      state.stake-=amount; state.balance+=amount; render();
      toast(`${textByLang[state.lang].unstakeDone}: ${fmt(amount)} PI`); log(`해지 ${fmt(amount)} PI / 잔액 ${fmt(state.balance)} PI`);
    }

    function ubiClaim(){ state.balance+=0.314; render(); toast(textByLang[state.lang].ubiPaid); log("UBI 지급 +0.314 PI"); }
    function ubiHistory(){ toast("최근 3회: +0.314 / +0.314 / +0.314"); log("UBI 내역: +0.314 / +0.314 / +0.314"); }

    // PWA(Service Worker 등록 시 캐시 사용)
    if("serviceWorker" in navigator){ navigator.serviceWorker.register("sw.js").catch(()=>{}); }

    render(); // 최초 렌더
  </script>
</body>
</html>
